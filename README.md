# MCP PowerShell Server

[![PowerShell](https://img.shields.io/badge/PowerShell-5.1%2B-blue.svg)](https://github.com/PowerShell/PowerShell)
[![MCP Protocol](https://img.shields.io/badge/MCP-2024--11--05-green.svg)](https://modelcontextprotocol.io/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)

MCP PowerShell Server - —ç—Ç–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ Model Context Protocol (MCP) –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è PowerShell —Å–∫—Ä–∏–ø—Ç–æ–≤. –°–µ—Ä–≤–µ—Ä –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è PowerShell –∫–æ–º–∞–Ω–¥ —á–µ—Ä–µ–∑ MCP –ø—Ä–æ—Ç–æ–∫–æ–ª —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–∑–æ–ª—è—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤, —Ç–∞–π–º–∞—É—Ç–æ–≤ –∏ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **MCP Protocol 2024-11-05** - –ü–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–µ–π –ø—Ä–æ—Ç–æ–∫–æ–ª–∞
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** - –ò–∑–æ–ª—è—Ü–∏—è —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—ã–µ PowerShell –ø—Ä–æ—Ü–µ—Å—Å—ã
- ‚è±Ô∏è **–ö–æ–Ω—Ç—Ä–æ–ª—å –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è** - –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ —Ç–∞–π–º–∞—É—Ç—ã (1-3600 —Å–µ–∫—É–Ω–¥)
- üìÅ **–ì–∏–±–∫–∞—è —Ä–∞–±–æ—á–∞—è —Å—Ä–µ–¥–∞** - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞–Ω–∏—è —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- üìä **–î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å —Ä–∞–∑–Ω—ã–º–∏ —É—Ä–æ–≤–Ω—è–º–∏
- üîÑ **STDIO –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –†–∞–±–æ—Ç–∞ —á–µ—Ä–µ–∑ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞
- üåê **UTF-8 –ø–æ–¥–¥–µ—Ä–∂–∫–∞** - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Unicode —Å–∏–º–≤–æ–ª–æ–≤
- ‚ö° **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞–∫–ª–∞–¥–Ω—ã–µ —Ä–∞—Å—Ö–æ–¥—ã
- üåê **HTTP/HTTPS —Å–µ—Ä–≤–µ—Ä** - mcp-powershell-http —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Bearer-—Ç–æ–∫–µ–Ω–∞
- üîê **–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è** - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ —Ç–æ–∫–µ–Ω
- üíª **–õ–æ–∫–∞–ª—å–Ω—ã–µ –∏ —É–¥–∞–ª—ë–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã** - MCP –∑–∞–ø—Ä–æ—Å—ã —á–µ—Ä–µ–∑ HTTP(S) POST

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- **Windows** 10/11 –∏–ª–∏ Windows Server 2016+
- **PowerShell** 5.1 –∏–ª–∏ –≤—ã—à–µ (–≤–∫–ª—é—á–∞—è PowerShell 7.x)
- **–ü—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è HTTPS —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –∫–æ–º–∞–Ω–¥)

### MCP Client
–õ—é–±–æ–π MCP-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–π –∫–ª–∏–µ–Ω—Ç, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π:
- MCP Protocol –≤–µ—Ä—Å–∏–∏ 2024-11-05
- STDIO –∏–ª–∏ HTTP(S) —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
- JSON-RPC 2.0

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ STDIO —Å–µ—Ä–≤–µ—Ä–∞
1. **–°–∫–∞—á–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç**:

    ```powershell
       Invoke-WebRequest -Uri "https://raw.githubusercontent.com/hypo69/mcp-powershell-stdio.ps1" -OutFile "mcp-powershell-stdio.ps1"
    ```

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**:

   ```powershell
   Get-ExecutionPolicy
   Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
   ```

3. **–¢–µ—Å—Ç–æ–≤—ã–π –∑–∞–ø—É—Å–∫**:

   ```powershell
   echo '{"jsonrpc":"2.0","id":1,"method":"initialize","params":{}}' | .\mcp-powershell-stdio.ps1
   ```

### –ë—ã—Å—Ç—Ä–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ HTTP(S) —Å–µ—Ä–≤–µ—Ä–∞

1. **–°–∫–∞—á–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç**:

   ```powershell
   Invoke-WebRequest -Uri "https://raw.githubusercontent.com/hypo69/mcp-powershell-http.ps1" -OutFile "mcp-powershell-http.ps1"
   ```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç** (–¥–ª—è HTTPS):

   ```powershell
   # –°–æ–∑–¥–∞–Ω–∏–µ self-signed —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (–æ–¥–∏–Ω —Ä–∞–∑)
   New-SelfSignedCertificate -DnsName "localhost" -CertStoreLocation "Cert:\LocalMachine\My"
   ```

3. **–ü—Ä–∏–≤—è–∑–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –∫ –ø–æ—Ä—Ç—É**:

   ```powershell
   netsh http add sslcert ipport=0.0.0.0:8091 certhash=<Thumbprint> appid='{00000000-0000-0000-0000-000000000000}'
   ```

4. **–ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞**:

   ```powershell
   powershell.exe -File .\mcp-powershell-http.ps1 -Port 8091 -ServerHost "localhost" -CertThumbprint "<Thumbprint>" -AuthToken "–≤–∞—à_—Ç–æ–∫–µ–Ω"
   ```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```powershell
$env:MCP_LOG_PATH = "C:\Logs\mcp-powershell.log"
$env:MCP_LOG_LEVEL = "INFO"
$env:MCP_MAX_LOG_SIZE = "50"
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö MCP –∫–ª–∏–µ–Ω—Ç–æ–≤

#### Claude Desktop

```json
{
  "mcpServers": {
    "powershell": {
      "command": "powershell.exe",
      "args": ["-File", "C:\\Path\\To\\mcp-powershell-http.ps1", "-Port", "8091", "-AuthToken", "token123"],
      "env": {
        "MCP_LOG_LEVEL": "INFO"
      }
    }
  }
}
```

#### VS Code Extension (Cline)

```json
{
  "mcp": {
    "powershell": {
      "command": "powershell.exe",
      "args": ["-File", "C:\\Path\\To\\mcp-powershell-http.ps1", "-Port", "8091", "-AuthToken", "token123"]
    }
  }
}
```

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTP(S) —Å–µ—Ä–≤–µ—Ä–∞

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

```http
POST https://localhost:8091/
Authorization: Bearer token123
Content-Type: application/json

{
  "jsonrpc": "2.0",
  "id": 1,
  "method": "tools/call",
  "params": {
    "name": "run-script",
    "arguments": {
      "script": "Get-ComputerInfo | Select-Object WindowsProductName, WindowsVersion",
      "timeoutSeconds": 30
    }
  }
}
```

**–û—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞:**

```json
{
  "jsonrpc": "2.0",
  "id": 1,
  "result": {
    "content": [
      {
        "type": "text",
        "text": "Windows 10 Pro, Version 22H2"
      }
    ]
  }
}
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ HTTP —Å–µ—Ä–≤–µ—Ä–∞

* –ü–æ–¥–¥–µ—Ä–∂–∫–∞ POST –∑–∞–ø—Ä–æ—Å–æ–≤ —Å JSON-RPC 2.0
* –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Bearer —Ç–æ–∫–µ–Ω
* –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã —á–µ—Ä–µ–∑ HTTPS —Å SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º
* –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –ø–æ—Ä—Ç –∏ —Ö–æ—Å—Ç

---

–û—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã README –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π: **–ë–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã**, **–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã**, **–ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞**, **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**, **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**, **–û—Ç–ª–∞–¥–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**, **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏**, **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤–∫–ª–∞–¥**, **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã**, **–õ–∏—Ü–µ–Ω–∑–∏—è**, **–ê–≤—Ç–æ—Ä—ã**, **–ü–æ–¥–¥–µ—Ä–∂–∫–∞**.

---

**–¢–µ–ø–µ—Ä—å README –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–∞–∫ `mcp-powershell-stdio`, —Ç–∞–∫ –∏ `mcp-powershell-http` —Å–µ—Ä–≤–µ—Ä—ã.**

```

